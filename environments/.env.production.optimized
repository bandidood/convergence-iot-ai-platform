# =============================================================================
# CONFIGURATION ENVIRONNEMENT PRODUCTION - Station Traffeyère IoT/AI Platform
# Déploiement Coolify optimisé - RNCP 39394
# =============================================================================

# =============================================================================
# PROJET RNCP 39394 - IDENTIFICATION
# =============================================================================
PROJECT_NAME="Station Traffeyère IoT/AI Platform"
PROJECT_VERSION="1.0.0"
RNCP_CODE="39394"
ENVIRONMENT=production
DEBUG=false

# =============================================================================
# DOMAINES ET URLS PRODUCTION
# =============================================================================
BASE_DOMAIN=johann-lebel.fr
FRONTEND_URL=https://frontend-station.johann-lebel.fr
BACKEND_URL=https://backend-station.johann-lebel.fr
GRAFANA_URL=https://grafana.johann-lebel.fr
PROMETHEUS_URL=https://prometheus.johann-lebel.fr
INFLUX_URL=https://influx.johann-lebel.fr
MINIO_URL=https://minio.johann-lebel.fr

# =============================================================================
# BASE DE DONNÉES POSTGRESQL + TIMESCALEDB
# =============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=station_traffeyere
POSTGRES_USER=postgres
POSTGRES_PASSWORD=TraffeyerePostgreSQL2024!SecureDB

# Base de données Grafana
GRAFANA_DB_PASSWORD=GrafanaDB2024!Monitoring

# =============================================================================
# CACHE REDIS
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=TraffeyereRedis2024!Cache
REDIS_URL=redis://:TraffeyereRedis2024!Cache@redis:6379/0

# =============================================================================
# INFLUXDB TIME-SERIES
# =============================================================================
INFLUX_USERNAME=admin
INFLUX_PASSWORD=TraffeyereInflux2024!TimeSeries
INFLUX_ORG=traffeyere
INFLUX_BUCKET=iot_sensors
INFLUX_ADMIN_TOKEN=TraffeyereInfluxToken2024ForIoTSensorsData127Capteurs

# =============================================================================
# MINIO S3 STORAGE
# =============================================================================
MINIO_ROOT_USER=traffeyere-admin
MINIO_ROOT_PASSWORD=TraffeyereMinIO2024!S3Storage
MINIO_ENDPOINT=minio:9000
MINIO_SERVER_URL=https://minio.johann-lebel.fr
S3_BUCKET=traffeyere-data
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY=traffeyere-admin
S3_SECRET_KEY=TraffeyereMinIO2024!S3Storage

# =============================================================================
# SÉCURITÉ ET AUTHENTIFICATION
# =============================================================================
SECRET_KEY=TraffeyereSecretKey2024ForFastAPIBackendRNCP39394StationIoT
JWT_SECRET=TraffeyereJWTSecret2024ForAuthenticationAndAuthorization
API_KEY=TraffeyereAPIKey2024ForExternalIntegrationsAndMonitoring
ENCRYPTION_KEY=TraffeyereAES256Key2024!ForDataEncryption

# =============================================================================
# MQTT BROKER CONFIGURATION
# =============================================================================
MQTT_BROKER_HOST=mosquitto
MQTT_BROKER_PORT=1883
MQTT_USERNAME=iot_station
MQTT_PASSWORD=TraffeyreMQTT2024!IoTBroker
MQTT_WS_PORT=8083

# =============================================================================
# STATION DE TRAITEMENT D'EAU - CONFIGURATION MÉTIER
# =============================================================================
STATION_ID=TRAFFEYERE_001
STATION_NAME=Station Traffeyère
STATION_LOCATION=45.764043,4.835659
STATION_TYPE=Wastewater Treatment Plant
STATION_CAPACITY=50000
SENSOR_COUNT=127

# Configuration IoT
IOT_PUBLISH_INTERVAL=5
IOT_ANOMALY_PROBABILITY=0.05
IOT_SIMULATION_SPEED=1.0
IOT_DATA_RETENTION_DAYS=30

# =============================================================================
# EDGE AI ENGINE - PERFORMANCE RNCP 39394
# =============================================================================
AI_MODEL_PATH=/app/models
AI_INFERENCE_TIMEOUT=280
AI_BATCH_SIZE=32
AI_MODEL_FORMAT=onnx
SHAP_ENABLED=true
ANOMALY_THRESHOLD=0.85
ANOMALY_WINDOW_SIZE=100

# Métriques performance RNCP
EDGE_AI_P95_TARGET_MS=0.28
WEBSOCKET_LATENCY_TARGET_MS=50
API_SLA_TARGET=0.999
MTTR_TARGET_MINUTES=11.3

# =============================================================================
# GRAFANA MONITORING
# =============================================================================
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=TraffeyereGrafana2024!Dashboard
GRAFANA_SECRET_KEY=TraffeyereGrafanaSecret2024ForSessions
GRAFANA_DOMAIN=grafana.johann-lebel.fr
GRAFANA_ROOT_URL=https://grafana.johann-lebel.fr

# Configuration base de données Grafana
GF_DATABASE_TYPE=postgres
GF_DATABASE_HOST=postgres:5432
GF_DATABASE_NAME=grafana
GF_DATABASE_USER=grafana
GF_DATABASE_PASSWORD=GrafanaDB2024!Monitoring

# =============================================================================
# NOTIFICATIONS ET ALERTING
# =============================================================================
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#traffeyere-monitoring
SLACK_USERNAME=Traffeyere-Bot

# Configuration SMTP pour emails
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=alerts@johann-lebel.fr
SMTP_PASSWORD=TraffeyereEmail2024!Alerts
SMTP_FROM=alerts@johann-lebel.fr
SMTP_TO=johann@johann-lebel.fr

# Destinataires alertes critiques
ALERT_EMAIL_CRITICAL=johann@johann-lebel.fr
ALERT_EMAIL_WARNING=monitoring@johann-lebel.fr

# =============================================================================
# APIs EXTERNES (OPTIONNELLES)
# =============================================================================
# OpenAI pour IA conversationnelle
OPENAI_API_KEY=sk-your-openai-api-key-here

# Anthropic Claude
ANTHROPIC_API_KEY=your-anthropic-api-key-here

# Google Cloud
GOOGLE_API_KEY=your-google-api-key-here

# Perplexity pour recherche augmentée
PERPLEXITY_API_KEY=your-perplexity-api-key-here

# =============================================================================
# CONFIGURATION SERVEURS ET PERFORMANCE
# =============================================================================
# Backend FastAPI
UVICORN_HOST=0.0.0.0
UVICORN_PORT=8000
UVICORN_WORKERS=4
UVICORN_LOG_LEVEL=info
UVICORN_RELOAD=false

# Frontend Nginx
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
NGINX_KEEPALIVE_TIMEOUT=65
NGINX_CLIENT_MAX_BODY_SIZE=10m

# =============================================================================
# MONITORING ET OBSERVABILITÉ
# =============================================================================
PROMETHEUS_ENABLED=true
JAEGER_ENABLED=false
LOG_LEVEL=info
LOG_JSON_FORMAT=true
METRICS_ENABLED=true

# Rétention métriques
PROMETHEUS_RETENTION_TIME=30d
PROMETHEUS_RETENTION_SIZE=10GB
INFLUXDB_RETENTION_DAYS=90

# =============================================================================
# LIMITES RESSOURCES CONTENEURS
# =============================================================================
# Backend
BACKEND_CPU_LIMIT=2.0
BACKEND_MEMORY_LIMIT=2G
BACKEND_CPU_REQUEST=0.5
BACKEND_MEMORY_REQUEST=512M

# Frontend
FRONTEND_CPU_LIMIT=0.5
FRONTEND_MEMORY_LIMIT=256M
FRONTEND_CPU_REQUEST=0.1
FRONTEND_MEMORY_REQUEST=64M

# Edge AI
EDGE_AI_CPU_LIMIT=2.0
EDGE_AI_MEMORY_LIMIT=4G
EDGE_AI_CPU_REQUEST=0.5
EDGE_AI_MEMORY_REQUEST=1G

# Bases de données
POSTGRES_CPU_LIMIT=2.0
POSTGRES_MEMORY_LIMIT=2G
REDIS_CPU_LIMIT=1.0
REDIS_MEMORY_LIMIT=1G
INFLUXDB_CPU_LIMIT=1.5
INFLUXDB_MEMORY_LIMIT=2G

# =============================================================================
# SÉCURITÉ ET CONFORMITÉ
# =============================================================================
# Conformité ISA/IEC 62443 SL2+
SECURITY_LEVEL=SL2+
TLS_VERSION=1.3
CIPHER_SUITE=ECDHE-RSA-AES256-GCM-SHA384

# Chiffrement
AES_KEY_SIZE=256
RSA_KEY_SIZE=4096
HASH_ALGORITHM=SHA256

# Session et cookies
SESSION_TIMEOUT=3600
COOKIE_SECURE=true
COOKIE_SAMESITE=Strict
CSRF_PROTECTION=true

# =============================================================================
# BACKUP ET DISASTER RECOVERY
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=traffeyere-backups
BACKUP_ENCRYPTION=true

# =============================================================================
# CI/CD ET DÉPLOIEMENT
# =============================================================================
COOLIFY_API_TOKEN=your-coolify-api-token-here
COOLIFY_URL=https://coolify.ccdigital.fr
GITHUB_REPO=https://github.com/your-username/station-traffeyere-iot-ai-platform

# Build et déploiement
BUILD_CACHE_ENABLED=true
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1
MULTI_ARCH_BUILD=true

# =============================================================================
# HEALTHCHECKS ET SLA
# =============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# SLA Objectives RNCP 39394
SLA_AVAILABILITY_TARGET=99.9
SLA_RESPONSE_TIME_TARGET=1000
SLA_ERROR_RATE_TARGET=0.1

# =============================================================================
# TIMEZONE ET LOCALISATION
# =============================================================================
TZ=Europe/Paris
LOCALE=fr_FR.UTF-8
LANGUAGE=fr

# =============================================================================
# IDENTITY & ACCESS MANAGEMENT - KEYCLOAK
# =============================================================================
KEYCLOAK_ADMIN_USER=admin
KEYCLOAK_ADMIN_PASSWORD=TraffeyereKeycloak2024!AdminPassword
KEYCLOAK_DB_PASSWORD=KeycloakDB2024!PostgreSQL
KEYCLOAK_REALM=traffeyere
KEYCLOAK_CLIENT_ID=station-backend
KEYCLOAK_CLIENT_SECRET=TraffeyereBackendClient2024Secret
KEYCLOAK_FRONTEND_CLIENT_ID=station-frontend
KEYCLOAK_GRAFANA_CLIENT_ID=grafana
KEYCLOAK_GRAFANA_CLIENT_SECRET=GrafanaKeycloakClient2024Secret

# Configuration SSO URLs
KEYCLOAK_URL=https://auth.johann-lebel.fr
KEYCLOAK_INTERNAL_URL=http://keycloak:8080
KEYCLOAK_ISSUER=https://auth.johann-lebel.fr/realms/traffeyere

# =============================================================================
# DIGITAL TWIN UNITY
# =============================================================================
UNITY_LOG_LEVEL=3
UNITY_APP_PATH=/app/unity/StationTraffeyere.x86_64
UNITY_API_PORT=8094
UNITY_WEB_PORT=8095
UNITY_WEBSOCKET_PORT=8096
UNITY_RENDERING_QUALITY=medium
UNITY_SENSOR_CACHE_SIZE=127
UNITY_WEBSOCKET_MAX_CONNECTIONS=200
UNITY_REALTIME_SYNC=true

# Digital Twin URLs
DIGITAL_TWIN_URL=https://digitaltwin.johann-lebel.fr
DIGITAL_TWIN_API_URL=https://digitaltwin-api.johann-lebel.fr
DIGITAL_TWIN_SYNC_ENABLED=true

# =============================================================================
# XAI (eXPLAINABLE AI) DASHBOARD
# =============================================================================
XAI_PORT=8092
XAI_WS_PORT=8093
XAI_URL=https://xai.johann-lebel.fr
XAI_SERVICE_URL=http://xai-dashboard:8092
XAI_EXPLANATIONS_ENABLED=true
XAI_EXPLANATIONS_AUTO=true

# Configuration XAI
SHAP_ENABLED=true
LIME_ENABLED=true
XAI_EXPLANATION_CACHE_TTL=300
XAI_MAX_CONCURRENT_EXPLANATIONS=10
XAI_EXPLANATION_TIMEOUT=30

# Méthodes XAI disponibles
XAI_METHODS=shap,lime,integrated_gradients
XAI_DEFAULT_METHOD=shap
XAI_CONFIDENCE_THRESHOLD=0.7

# =============================================================================
# ENCRYPTION ET SÉCURITÉ AVANCÉE
# =============================================================================
ENCRYPTION_KEY=TraffeyereAES256Key2024!ForDataEncryptionAndSecureStorage
JWT_EXPIRATION_HOURS=24
SESSION_ENCRYPTION_KEY=SessionEncryption2024!TraffeyereSecure

# =============================================================================
# URLS COMPLÈTES DE TOUS LES SERVICES
# =============================================================================
# Services principaux
FRONTEND_URL=https://frontend-station.johann-lebel.fr
BACKEND_URL=https://backend-station.johann-lebel.fr
API_URL=https://api.johann-lebel.fr

# Monitoring
GRAFANA_URL=https://grafana.johann-lebel.fr
PROMETHEUS_URL=https://prometheus.johann-lebel.fr
ALERTMANAGER_URL=https://alerts.johann-lebel.fr

# Bases de données
INFLUX_URL=https://influx.johann-lebel.fr
MINIO_URL=https://minio.johann-lebel.fr
MINIO_CONSOLE_URL=https://minio-console.johann-lebel.fr

# Services avancés
KEYCLOAK_URL=https://auth.johann-lebel.fr
DIGITAL_TWIN_URL=https://digitaltwin.johann-lebel.fr
DIGITAL_TWIN_API_URL=https://digitaltwin-api.johann-lebel.fr
XAI_URL=https://xai.johann-lebel.fr
MQTT_WS_URL=wss://mqtt.johann-lebel.fr

# =============================================================================
# CONFIGURATION RÉSEAU AVANCÉE
# =============================================================================
# Sous-réseaux Docker
BACKEND_SUBNET=172.31.0.0/16
FRONTEND_SUBNET=172.32.0.0/16
IOT_NETWORK_SUBNET=172.33.0.0/16

# Configuration CORS
CORS_ALLOWED_ORIGINS=https://frontend-station.johann-lebel.fr,https://traffeyere.johann-lebel.fr,https://digitaltwin.johann-lebel.fr,https://xai.johann-lebel.fr
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,Accept,Origin

# =============================================================================
# CONFIGURATION AVANCÉE PERFORMANCE
# =============================================================================
# Digital Twin Unity
UNITY_CPU_LIMIT=2.0
UNITY_MEMORY_LIMIT=4G
UNITY_CPU_REQUEST=0.5
UNITY_MEMORY_REQUEST=1G

# XAI Dashboard
XAI_CPU_LIMIT=1.5
XAI_MEMORY_LIMIT=2G
XAI_CPU_REQUEST=0.3
XAI_MEMORY_REQUEST=512M

# Keycloak
KEYCLOAK_CPU_LIMIT=2.0
KEYCLOAK_MEMORY_LIMIT=2G
KEYCLOAK_CPU_REQUEST=0.5
KEYCLOAK_MEMORY_REQUEST=512M

# =============================================================================
# CONFIGURATION MÉTIER STATION D'ÉPURATION
# =============================================================================
# Types de traitement
TREATMENT_TYPES=biological,chemical,mechanical,advanced
WATER_QUALITY_STANDARDS=EU,WHO,EPA
TREATMENT_CAPACITY_M3_DAY=50000
MAX_FLOW_RATE_M3_H=2500

# Paramètres de qualité
PH_MIN=6.5
PH_MAX=8.5
TURBIDITY_MAX_NTU=10
BOD5_MAX_MG_L=25
COD_MAX_MG_L=125
NH4_MAX_MG_L=10
PO4_MAX_MG_L=2

# =============================================================================
# DÉVELOPPEMENT ET DEBUG (DÉSACTIVÉ EN PRODUCTION)
# =============================================================================
DEVELOPMENT_MODE=false
DEBUG_MODE=false
TESTING_MODE=false
PROFILING_ENABLED=false
VERBOSE_LOGGING=false
